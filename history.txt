#V2
-- Setup
CREATE guitar_setup CONTENT { guitar_id: $g.id, strings: "Stringjoy 10-46 Pure Nickel", tuning: "Standard", action: "4/64", nut_material: "Unbleached Polished Bone", truss_rod: "2-Way Adjustable" };
-- Case / COA
CREATE guitar_case CONTENT { guitar_id: $g.id, type: "Hard case", coa_included: true, notes: "" };
-- Pickups (2x)
CREATE guitar_pickups CONTENT { guitar_id: $g.id, position: "Neck", type: "Humbucker", model: "Custom Throbak PAF", winding: "" };
CREATE guitar_pickups CONTENT { guitar_id: $g.id, position: "Bridge", type: "Humbucker", model: "Custom Throbak PAF", winding: "" };
-- Controls (5x)
CREATE guitar_controls CONTENT { guitar_id: $g.id, name: "Volume", detail: "CTS 550k Potentiometer" };
CREATE guitar_controls CONTENT { guitar_id: $g.id, name: "Tone", detail: "CTS 550k Potentiometer" };
CREATE guitar_controls CONTENT { guitar_id: $g.id, name: "3-way Toggleswitch", detail: "Switchcraft" };
-- 1) Find or create the core guitar, keep its id in $g
LET $found = (SELECT id, created_at FROM guitars WHERE brand = "Banker" AND model = "Ironman CT Standard" ORDER BY created_at DESC LIMIT 1);
LET $g = (IF array::len($found) = 0 THEN (CREATE guitars CONTENT { brand: "Banker", model: "Ironman CT Standard", body_style: "Bound Double Cutaway", line: "", variant: "", year_reference: "", weight: "", price_cents: 0, price_currency: "USD", serial_number: "" } RETURN AFTER) ELSE $found[0] END);
DELETE FROM guitar_dimensions WHERE guitar_id = $g.id;
DELETE FROM guitar_appointments WHERE guitar_id = $g.id;
DELETE FROM guitar_woods WHERE guitar_id = $g.id;
DELETE FROM guitar_finish WHERE guitar_id = $g.id;
DELETE FROM guitar_hardware WHERE guitar_id = $g.id;
DELETE FROM guitar_setup WHERE guitar_id = $g.id;
DELETE FROM guitar_case WHERE guitar_id = $g.id;
DELETE FROM guitar_pickups WHERE guitar_id = $g.id;
DELETE FROM guitar_controls WHERE guitar_id = $g.id;
CREATE guitar_dimensions CONTENT { guitar_id: $g.id, scale_length: "24 3/4", nut_width: "1 5/8", neck_profile: "60 C Shape", neck_thickness_1st: ".91", neck_thickness_12th: ".93", fingerboard_radius: "12", fret_count: 22, fret_type: "Jescar 45085 Nickel Silver", binding: "Bound" };
CREATE guitar_appointments CONTENT { guitar_id: $g.id, binding_body: "Bound body", binding_fingerboard: "1-Ply fingerboard binding", inlays: "Vintage Trapezoid", headstock_veneer: "", other: "" };
CREATE guitar_woods CONTENT { guitar_id: $g.id, top: "Carved Flame Maple Top", body: "Honduran Mahogany", neck: "Quartersawn Honduran Mahogany", fingerboard: "Rosewood", neck_joint: "", top_carve: "Carved" };
CREATE guitar_finish CONTENT { guitar_id: $g.id, color: "Vintage Sunburst", type: "Nitrocellulose Lacquer", aging: "", colors: ["Vintage Sunburst","Goldtop"], notes: "" };
CREATE guitar_hardware CONTENT { guitar_id: $g.id, material: "Nickel", bridge: "Faber ABR-H", tailpiece: "Tailpiece with Collarless Locking Studs", tuners: "Grover Rotomatic", pickguard: "", pickup_rings: "M69 Mounting Rings", notes: "" };
CREATE guitar_setup CONTENT { guitar_id: $g.id, strings: "Stringjoy 10-46 Pure Nickel", tuning: "Standard", action: "4/64", nut_material: "Unbleached Polished Bone", truss_rod: "2-Way Adjustable" };
CREATE guitar_case CONTENT { guitar_id: $g.id, type: "Hard case", coa_included: true, notes: "" };
CREATE guitar_pickups CONTENT { guitar_id: $g.id, position: "Neck", type: "Humbucker", model: "Custom Throbak PAF", winding: "" };
CREATE guitar_pickups CONTENT { guitar_id: $g.id, position: "Bridge", type: "Humbucker", model: "Custom Throbak PAF", winding: "" };
CREATE guitar_controls CONTENT { guitar_id: $g.id, name: "Volume", detail: "CTS 550k Potentiometer" };
CREATE guitar_controls CONTENT { guitar_id: $g.id, name: "Tone", detail: "CTS 550k Potentiometer" };
CREATE guitar_controls CONTENT { guitar_id: $g.id, name: "3-way Toggleswitch", detail: "Switchcraft" };
SELECT id, brand, model FROM guitars WHERE id = $g.id;
SELECT count() AS dim_count FROM guitar_dimensions WHERE guitar_id = $g.id;
SELECT count() AS pickup_count FROM guitar_pickups WHERE guitar_id = $g.id;
SELECT count() AS control_count FROM guitar_controls WHERE guitar_id = $g.id;
SELECT id,brand,model,created_at FROM guitars WHERE brand="Banker" AND model="Ironman CT Standard" ORDER BY created_at DESC LIMIT 1;
SELECT count() FROM guitar_dimensions WHERE guitar_id = (SELECT id,created_at FROM guitars WHERE brand="Banker" AND model="Ironman CT Standard" ORDER BY created_at DESC LIMIT 1)[0].id;
SELECT id,brand,model,created_at FROM guitars WHERE brand="Banker" AND model="Ironman CT Standard" ORDER BY created_at DESC LIMIT 1;
SELECT count() FROM guitar_dimensions WHERE guitar_id = (SELECT id,created_at FROM guitars WHERE brand="Banker" AND model="Ironman CT Standard" ORDER BY created_at DESC LIMIT 1)[0].id;
SELECT count() FROM guitar_pickups   WHERE guitar_id = (SELECT id,created_at FROM guitars WHERE brand="Banker" AND model="Ironman CT Standard" ORDER BY created_at DESC LIMIT 1)[0].id;
SELECT count() FROM guitar_controls  WHERE guitar_id = (SELECT id,created_at FROM guitars WHERE brand="Banker" AND model="Ironman CT Standard" ORDER BY created_at DESC LIMIT 1)[0].id;
INFO FOR DB;
SELECT * FROM guitars LIMIT 3;
SELECT count() FROM guitars;
INFO FOR DB;
SELECT * FROM guitars LIMIT 3;
BEGIN;
-- Core guitar
-- Banker 58' Spec V — SurrealDB seed (generated from _upsert-template.surql pattern)
-- Params (edit these if needed)
LET $brand = "Banker"; LET $model = "58' Spec V"; LET $body_style = "V"; LET $line = ""; LET $variant = ""; LET $serial = "";
-- Find or create the guitar (keep created_at in projection since we ORDER BY it in the template)
LET $found = (SELECT id, created_at FROM guitars WHERE brand = $brand AND model = $model ORDER BY created_at DESC LIMIT 1);
LET $g = (IF array::len($found) = 0 THEN (  CREATE guitars CONTENT {    brand: $brand,    line:  $line,    model: $model,    variant: $variant,    year_reference: "1958",    body_style: $body_style,    weight: "",    serial_number: $serial  } RETURN AFTER) ELSE $found[0] END);
-- Clear existing children to avoid duplicates when re-running
DELETE FROM guitar_dimensions WHERE guitar_id = $g.id; DELETE FROM guitar_appointments WHERE guitar_id = $g.id; DELETE FROM guitar_woods WHERE guitar_id = $g.id; DELETE FROM guitar_finish WHERE guitar_id = $g.id; DELETE FROM guitar_hardware WHERE guitar_id = $g.id; DELETE FROM guitar_setup WHERE guitar_id = $g.id; DELETE FROM guitar_case WHERE guitar_id = $g.id; DELETE FROM guitar_pickups WHERE guitar_id = $g.id; DELETE FROM guitar_controls WHERE guitar_id = $g.id;
-- Add children (fields are optional per schema; fill what we know)
-- Banker 58' Spec V — SurrealDB seed (corrected quoting and balanced blocks)
LET $brand = 'Banker';
LET $model = '58\\' Spec V';
LET $body_style = 'V';
LET $line = '';
LET $variant = '';
LET $serial = '';
-- Find or create the guitar
LET $found = (SELECT id, created_at FROM guitars WHERE brand = $brand AND model = $model ORDER BY created_at DESC LIMIT 1);
LET $g = (  IF array::len($found) = 0 THEN (    CREATE guitars CONTENT {      brand: $brand,      line:  $line,      model: $model,      variant: $variant,      year_reference: '1958',      body_style: $body_style,      weight: '',      serial_number: $serial    } RETURN AFTER  ) ELSE $found[0] END);
-- Clear existing children to avoid duplicates when re-running
DELETE FROM guitar_dimensions WHERE guitar_id = $g.id;
DELETE FROM guitar_appointments WHERE guitar_id = $g.id;
DELETE FROM guitar_woods       WHERE guitar_id = $g.id;
DELETE FROM guitar_finish      WHERE guitar_id = $g.id;
DELETE FROM guitar_hardware    WHERE guitar_id = $g.id;
DELETE FROM guitar_setup       WHERE guitar_id = $g.id;
DELETE FROM guitar_case        WHERE guitar_id = $g.id;
DELETE FROM guitar_pickups     WHERE guitar_id = $g.id;
DELETE FROM guitar_controls    WHERE guitar_id = $g.id;
-- Children
CREATE guitar_dimensions CONTENT {  guitar_id: $g.id,  scale_length: '24 3/4" (Vintage "Rule of 18")',  nut_width: '1 11/16"',  neck_profile: "'58 D Shape",  neck_thickness_1st: '.94',  neck_thickness_12th: '.97',  fingerboard_radius: '12"',  fret_count: 22,  fret_type: 'Jescar 45085 Nickel Silver',  binding: ''};
CREATE guitar_appointments CONTENT {  guitar_id: $g.id,  binding_body: '',  binding_neck: '',  binding_headstock: '',  side_dots: '',  fingerboard: '',  inlays: '',  headstock_veneer: '',  other: ''};
CREATE guitar_woods CONTENT {  guitar_id: $g.id,  top: '',  body: 'Korina',  neck: 'Quartersawn Korina',  fingerboard: 'Rosewood',  neck_joint: '',  top_carve: ''};
CREATE guitar_finish CONTENT {  guitar_id: $g.id,  color: 'Natural',  type: 'Nitrocellulose Lacquer',  aging: 'Aged',  colors: [],  notes: ''};
CREATE guitar_hardware CONTENT {  guitar_id: $g.id,  material: '',  bridge: 'Faber ABR-H',  tailpiece: 'Solid Brass "V" Tailpiece',  tuners: 'Kluson Deluxe Keystone',  pickguard: '4 Ply White',  pickup_rings: '',  notes: ''};
CREATE guitar_setup CONTENT {  guitar_id: $g.id,  strings: 'Stringjoy 10–46 Pure Nickel',  tuning: 'Standard',  action: '4/64',  nut_material: 'Unbleached Polished Bone',  truss_rod: '2-Way Adjustable'};
CREATE guitar_case CONTENT {  guitar_id: $g.id,  type: '',  coa_included: true,  notes: ''};
CREATE guitar_pickups CONTENT { guitar_id: $g.id, position: 'Neck',   type: 'Humbucker', model: 'PAF Humbucker', winding: '' };
CREATE guitar_pickups CONTENT { guitar_id: $g.id, position: 'Bridge', type: 'Humbucker', model: 'PAF Humbucker', winding: '' };
CREATE guitar_controls CONTENT { guitar_id: $g.id, name: 'Volume', detail: 'CTS 550k Potentiometer' };
CREATE guitar_controls CONTENT { guitar_id: $g.id, name: 'Tone', detail: 'CTS 550k Potentiometer' };
CREATE guitar_controls CONTENT { guitar_id: $g.id, name: '3-way Toggleswitch', detail: 'Switchcraft' };
-- Summary (optional)
SELECT id, brand, model FROM guitars WHERE id = $g.id;
SELECT count() AS pickup_count FROM guitar_pickups WHERE guitar_id = $g.id;
SELECT count() AS control_count FROM guitar_controls WHERE guitar_id = $g.id;
INFO FOR DB;
SELECT * FROM guitars;
